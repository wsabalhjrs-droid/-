---
sidebar_label: Using Endpoints With Wildcard Domains 
title: How Do I Use Wildcard Endpoints?
description: Learn how to create endpoints that receive traffic for all subdomains matching a wildcard domain.
---

import TabItem from "@theme/TabItem";
import Tabs from "@theme/Tabs";
import WildcardAgentConfigExample from "/examples/agent-config/http-wildcard-domain.mdx";
import WildcardKubernetesExample from "/examples/k8s/http-wildcard-domain.mdx";
import { LangSwitcher } from "@site/src/components/LangSwitcher";

You can create an endpoint which will receive traffic for all of the subdomains matching a given wildcard domain like `*.example.com`. You must create a [wildcard domain](/universal-gateway/domains/what-are-domains/#wildcard-domains) to create a public wildcard endpoint.

For example, if you create the wildcard endpoint `https://*.example.com`, it
will receive traffic for `https://foo.example.com` and
`https://bar.example.com`.

- Connections to URLs which match an online wildcard endpoint will be routed to
  it. For example, if you have created a wildcard endpoint
  `https://*.example.com`, connections to `https://foo.bar.baz.example.com` will
  route to it.
- Connections are routed to the most specific online endpoint. For example, if
  the endpoints `https://*.example.com` and `https://app.example.com` are both
  online, a connection to `https://app.example.com` will not be routed to the
  wildcard endpoint.

## Getting started

The following example creates a wildcard endpoint that forwards traffic to port `80`.

<Tabs groupId="endpoint-type" queryString="ept">
	<TabItem value="agent-endpoint" label="Agent Endpoint">
<LangSwitcher>
```bash
ngrok http 80 --url "https://*.example.com"
```

```sh tabName="SSH"
ssh -R '*.example.com:443:localhost:80' v2@connect.ngrok-agent.com http
```

```go
import (
	"context"
	"net"

	"golang.ngrok.com/ngrok"
	"golang.ngrok.com/ngrok/config"
)

func ngrokListener(ctx context.Context) (net.Listener, error) {
	return ngrok.Listen(ctx,
		config.HTTPEndpoint(
                        config.WithDomain("*.example.com"),
                ),
		ngrok.WithAuthtokenFromEnv(),
	)
}
```

```jsx
const ngrok = require("@ngrok/ngrok");

(async function () {
	const listener = await ngrok.forward({
		addr: 8080,
		authtoken_from_env: true,
		domain: "*.example.com",
	});

	console.log(`Ingress established at: ${listener.url()}`);
})();
```

```python
import ngrok

listener = ngrok.forward("localhost:8080", authtoken_from_env=True,
    domain="*.example.com")

print(f"Ingress established at: {listener.url()}");
```

```rust
use ngrok::prelude::*;

async fn listen_ngrok() -> anyhow::Result<impl Tunnel> {
    let sess = ngrok::Session::builder()
        .authtoken_from_env()
        .connect()
        .await?;

    let tun = sess
        .http_endpoint()
        .domain("*.example.com")
        .listen()
        .await?;

    println!("Listening on URL: {:?}", tun.url());

    Ok(tun)
}
```

</LangSwitcher>
</TabItem>
<TabItem value="agent-config" label="Agent Config" default>
	<WildcardAgentConfigExample />
</TabItem>
<TabItem value="k8s" label="Kubernetes Controller">
	<WildcardKubernetesExample />
</TabItem>
</Tabs>

## Wildcard endpoint pooling

Wildcard endpoints do not pool with non-wildcard URLs. For example, if you have two endpoints online, `https://foo.example.com` and `https://*.example.com`, they will not pool together and traffic to `https://foo.example.com` will not be load balanced.

## Using multiple endpoints with wildcard subdomains

With the [Agent CLI](/agent/cli), you can create separate public endpoints for subdomains of a wildcard domain no matter where the upstream services are running. See [the Domains docs](/docs/universal-gateway/domains/#wildcard-domains) for more information.

For example, if you reserve `*.example.com` and want to route requests to `api1.example.com` and `api2.example.com`, you can specify subdomains via the CLI. ngrok will handle routing requests to the correct endpoint, even if they're on different ports.

The first one might be at port `80`:

```bash
ngrok http 80 --url https://api1.example.com
```

While the second is at port `81`:

```bash
ngrok http 81 --url https://api2.example.com
```

:::tip
This is only necessary for creating _public_ endpoints to subdomains. Internal endpoints don't require a domain.
:::
